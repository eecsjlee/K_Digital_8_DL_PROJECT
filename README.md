# 차량 객체 추출 기반 차량번호판 추출 및 예측 서비스
[K-Digital 부산대 8회차] AI 활용 빅데이터분석 풀스택웹서비스 SW 개발자 양성과정 프로젝트

- **주제:** 차량물류정보시스템에 대해 인식 오류로 인한 모델 개선 및 고철장 웹서비스 기능 제공
- **목표:** 정확도 높은 번호판 인식을 이용한 안전한 무정차 계근 시스템 구축, 이용자가 원하는
            정보를 직관적으로 확인 가능

<br/>

## 📈 개발 기간
> 2025.01.13 - 2025.02.18.

<br/>

## 📝 활용 데이터 
- `동연 SNT` 고장 유형별 이미지
- `공개 데이터` AI HUB 자동차 번호판 이미지
- `공개 데이터` MNIST 숫자 손글씨 데이터셋

<br/>

## 👥 팀원 구성

|이름|담당|GITHUB|
|:------:|:---:|---|
|박래찬|Data-Analysis|https://github.com/chani1352|
|김좌현|FRONT-END|https://github.com/chani1352|
|이준영|FRONT-END|https://github.com/iambean-git|

<br/>

## 🔧 시스템 구성
![image](https://github.com/user-attachments/assets/79db92d9-fc06-4ab2-9d39-6151d76028bc)

<br/>
<br/>

## 📋 데이터 분석 프로세스
### 1. 데이터 수집
> - 기업에서 전달받은 고장 유형별 이미지 (27장)
> - AI HUB 자동차 번호판 이미지 (80,000장)
> - MNIST 숫자 손글씨 데이터 (70,000장)

<br/>

### 2. 데이터 전처리
> - 차량 이미지에서 차량 번호판 탐지 후 추출
> - 추출된 차량 번호판에서 숫자 6자리 탐지 후 숫자로만 처리된 이미지로 변경 (한글 데이터셋 부족으로 숫자 데이터로만 모델 학습)
> - 숫자로만 처리된 이미지에서 숫자를 인식하기 위한 이미지 전처리 기법 적용

<br/>

### 3. 사용한 모델
> - 차량 번호판 탐지 모델(keremberke/yolov5m-license-plate)
>   - 번호판 탐지 후 좌표 및 정확도 추출
> - 이미지 화질 개선 모델(Real-ESRGAN)
    - 추출된 번호판 이미지의 화질이 떨어져 OCR 인식 어려움
> - 숫자 탐지 모델(yolov5s)
>   - 숫자 6자리 탐지 후 좌표 및 정확도 추출
> - 문자열 비교 모델(Levenshtein)
>   - 인식된 문자열 성능 평가를 위한 라이브러리 사용
> - OCR 인식 모델(Optical Character Recognition)
>   - EasyOCR
>   - PaddleOCR
>   - EasyOCR 성능 대비 PaddleOCR 성능이 84%로 더 좋았음
> - 숫자 인식 모델(CNN)
>   - 한글 제외 숫자로만 처리된 이미지 PaddleOCR 성능 94% 나옴
>   - 초기 목표인 95%이상 달성을 위한 OCR모델이 아닌 CNN 모델 구현
>   - 최종 성능 평가 시 CNN모델 성능 99% 달성
    (모든 성능은 기업에서 받은 27장 이미지 기준)

<br/>

### 4. 문제점
> - 차량 번호판 탐지 문제
>   - 번호판을 정확하게 탐지하지만, 번호판이 아닌 객체도 번호판으로 잘못 탐지하는 문제 발생
> - 이미지 전처리 로딩 시간 문제
>   - 화질 개선(Real-ESRGAN 등)과 같은 여러 전처리 기법을 적용할 경우, 이미지 로딩 시간이 지나치게 길어지는 문제
> - 차량 번호판의 숫자 탐지 문제
>   - 숫자가 아닌 것을 숫자로 잘못 탐지하는 문제 발생.
>   - 숫자를 탐지한 후, 차량 번호 순서가 아닌 탐지 정확도를 기준으로 번호를 정렬하는 문제
> - 숫자 인식 문제
>   - OCR 모델의 성능 한계로 인해 숫자 인식에 한계가 있는 문제.

<br/>

### 5. 해결방안
> - 차량 번호판 탐지 문제
>   - 탐지된 객체 중 정확도가 높은 객체를 번호판으로 인식.
>   - 탐지된 객체에 대해 문자열 인식(OCR)을 실행하여 문자가 확인되면 번호판으로 인식.
>   - 두 가지 방법 중 두 번째 방법인 문자열 인식을 통해 차량 번호판을 정확히 탐지 방안 선택.
> - 차량 번호판의 숫자 탐지 문제
>   - CNN 모델 훈련 시, 숫자가 아닌 객체를 훈련 데이터에 포함시켜 숫자 인식 시 발생할 수 있는 예외를 처리.
>   - 탐지된 숫자의 x좌표를 기준으로 정렬한 후, YOLO로 탐지된 숫자의 좌표를 활용하여 일차 함수식을 계산. 이를 통해 번호판 숫자의 위치를 1열/2열로 구분.
> - 숫자 인식 문제
>   - AI HUB의 자동차 번호판 이미지를 활용하여 훈련 데이터 세트를 확보하고, 이를 바탕으로 CNN 모델을 학습시켜 숫자 인식 성능을 개선.

<br/>

### 6. 평가
> - 기업에서 전달받은 27장의 이미지를 테스트 테이터로 사용
>   - 번호판 탐지 -> 숫자 탐지 -> 이미지 전처리 -> 숫자 인식 -> 차량 번호 예측
>      - 숫자 인식 정확도 99%(27장 중 25장 성공)
>      - 2장의 이미지의 숫자 중 1개씩 인식 실패
>   - CNN모델로 인식한 숫자 6개를 DB에 등록된 차량 번호 조회 후 Levenshtein 문자열 비교 라이브러리를 사용하여 정확도가 높은 차량 번호 선택
>      - 차량 번호 예측 정확도 100%(27장 모두 성공)

<br/>

## 참고자료

> - 번호판 검출 모델(yolo5) : https://huggingface.co/keremberke/yolov5m-license-plate 
> - yolov5 모델 학습 : https://put-idea.tistory.com/52
> - EasyOCR 인식 모델 : https://github.com/JaidedAI/EasyOCR
> - PaddleOCR 인식 모델 : https://github.com/PaddlePaddle/PaddleOCR
> - 이미지 화질 개선 모델 : https://github.com/xinntao/Real-ESRGAN
> - 라벨링 도구(labelimg) : https://github.com/HumanSignal/labelImg
> - 논문 참조 : https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=9003211

